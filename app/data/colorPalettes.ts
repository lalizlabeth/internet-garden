// Authentic Wada Sanzo 4-color palettes from 'A Dictionary of Color Combinations'
// Source: https://www.wada-sanzo-colors.com/combinations/classic/fourColors

export type ColorPalette = {
  id: number;
  colors: [string, string, string, string];
};

export const colorPalettes: ColorPalette[] = [
  { id: 241, colors: ["#DD4027", "#FFEFAE", "#C5A56E", "#547076"] },
  { id: 242, colors: ["#F37F94", "#AE5224", "#008842", "#111314"] },
  { id: 243, colors: ["#BB7125", "#EBD3A2", "#6B7140", "#34454C"] },
  { id: 244, colors: ["#B59392", "#C56127", "#6D7E77", "#007190"] },
  { id: 245, colors: ["#A62C37", "#819238", "#12354E", "#34454C"] },
  { id: 246, colors: ["#F8B6BA", "#A84222", "#F5ECC2", "#FDC57E"] },
  { id: 247, colors: ["#BB7125", "#FFDD00", "#00978D", "#1C4286"] },
  { id: 248, colors: ["#F37F94", "#BC892B", "#B5B1D8", "#704357"] },
  { id: 249, colors: ["#793327", "#C2AE93", "#D6B43E", "#547076"] },
  { id: 251, colors: ["#A72144", "#FFF200", "#008842", "#34454C"] },
  { id: 252, colors: ["#DA525D", "#BB7125", "#C19F2C", "#099197"] },
  { id: 253, colors: ["#F8ED43", "#F68C50", "#501345", "#34454C"] },
  { id: 254, colors: ["#F8B6BA", "#F5ECC2", "#837E31", "#CA92A8"] },
  { id: 255, colors: ["#BB7125", "#CAB356", "#78CDD0", "#111314"] },
  { id: 256, colors: ["#EEA78C", "#F37420", "#009465", "#111314"] },
  { id: 257, colors: ["#E31F26", "#FCB315", "#006EB8", "#A36AA5"] },
  { id: 258, colors: ["#802626", "#EEB480", "#837E31", "#007190"] },
  { id: 259, colors: ["#F8ED43", "#099197", "#005B8D", "#A1A39A"] },
  { id: 260, colors: ["#D46D7A", "#EEA78C", "#B4CDC2", "#00B49B"] },
  { id: 261, colors: ["#A72144", "#FFEFAE", "#78CDD0", "#A1A39A"] },
  { id: 262, colors: ["#DA525D", "#EBD3A2", "#A49531", "#437742"] },
  { id: 263, colors: ["#AE5224", "#EEB480", "#B5DECC", "#34454C"] },
  { id: 264, colors: ["#F8B6BA", "#DD4027", "#B7C2A9", "#0093A5"] },
  { id: 265, colors: ["#D46D7A", "#FFDD00", "#A6A159", "#0D1C43"] },
  { id: 266, colors: ["#E31F26", "#EBD3A2", "#788860", "#00978D"] },
  { id: 267, colors: ["#FDBF68", "#F99D1B", "#00978D", "#006EB8"] },
  { id: 268, colors: ["#B59392", "#BB7125", "#253122", "#BCE4E5"] },
  { id: 269, colors: ["#BB7125", "#802626", "#A36AA5", "#111314"] },
  { id: 270, colors: ["#C53C69", "#A49531", "#B5DECC", "#BCE4E5"] },
  { id: 271, colors: ["#F48067", "#A84222", "#A6A159", "#1C4286"] },
  { id: 272, colors: ["#AE5224", "#F3A257", "#BCE4E5", "#111314"] },
  { id: 273, colors: ["#E2625E", "#FBE6A0", "#7A4456", "#B984AF"] },
  { id: 274, colors: ["#F99D1B", "#8B835B", "#BCE4E5", "#00978D"] },
  { id: 275, colors: ["#F48067", "#AFD472", "#00B49B", "#BCE4E5"] },
  { id: 276, colors: ["#C56127", "#F8ED43", "#A5C8D1", "#40456A"] },
  { id: 277, colors: ["#AB544D", "#EBD3A2", "#437742", "#34454C"] },
  { id: 278, colors: ["#DA525D", "#F99D1B", "#7A4456", "#B984AF"] },
  { id: 279, colors: ["#D8A37B", "#CAB356", "#00B49B", "#B984AF"] },
  { id: 280, colors: ["#DA525D", "#F99D1B", "#BCE4E5", "#6450A1"] },
  { id: 281, colors: ["#A62C37", "#EBD3A2", "#6B7140", "#78CDD0"] },
  { id: 282, colors: ["#DA525D", "#C59F6B", "#96D1AA", "#B984AF"] },
  { id: 283, colors: ["#AB544D", "#802626", "#719470", "#62C6BF"] },
  { id: 284, colors: ["#E2625E", "#FFDD00", "#00B49B", "#004F46"] },
  { id: 285, colors: ["#B59392", "#AE5224", "#F15A30", "#B5DECC"] },
  { id: 286, colors: ["#AE5224", "#FCB315", "#00939B", "#40456A"] },
  { id: 287, colors: ["#F37F94", "#CAB356", "#A7D4E4", "#78CDD0"] },
  { id: 288, colors: ["#F99D1B", "#644B1E", "#7A4456", "#111314"] },
  { id: 289, colors: ["#F8ED43", "#C7D14F", "#40456A", "#0D1C43"] },
  { id: 290, colors: ["#6D4145", "#FFEFAE", "#555832", "#96D1AA"] },
  { id: 291, colors: ["#C7D14F", "#00B49B", "#96D1AA", "#78CDD0"] },
  { id: 292, colors: ["#FFEFAE", "#EEB480", "#C5A56E", "#C2AE93"] },
  { id: 293, colors: ["#BB7125", "#B5DECC", "#709390", "#489B6E"] },
  { id: 294, colors: ["#F5ECC2", "#FDBF68", "#437742", "#97ACC8"] },
  { id: 295, colors: ["#FDBF68", "#FFF200", "#006EB8", "#0D1C43"] },
  { id: 296, colors: ["#F5ECC2", "#D8A37B", "#71502F", "#34454C"] },
  { id: 297, colors: ["#AE5224", "#F99D1B", "#6B7140", "#40456A"] },
  { id: 298, colors: ["#BB7125", "#F8ED43", "#F15A30", "#111314"] },
  { id: 299, colors: ["#C53C69", "#EEA78C", "#819238", "#007190"] },
  { id: 300, colors: ["#F48067", "#FDBF68", "#B5DECC", "#78CDD0"] },
  { id: 301, colors: ["#E31F26", "#EBD3A2", "#788860", "#A36AA5"] },
  { id: 302, colors: ["#FDBF68", "#C2AE93", "#BCE4E5", "#007190"] },
  { id: 303, colors: ["#FBE6A0", "#F15A30", "#253122", "#B6BFC1"] },
  { id: 304, colors: ["#793327", "#FDBF68", "#8B835B", "#00978D"] },
  { id: 305, colors: ["#EEB480", "#FFDD00", "#B2B73E", "#B5DECC"] },
  { id: 306, colors: ["#F8ED43", "#00978D", "#009465", "#BCE4E5"] },
  { id: 307, colors: ["#CC1236", "#B5B1D8", "#A36AA5", "#501345"] },
  { id: 308, colors: ["#D1B0A7", "#CB2F43", "#D96629", "#96D1AA"] },
  { id: 309, colors: ["#F3A257", "#F68C50", "#40456A", "#111314"] },
  { id: 310, colors: ["#DA525D", "#F5ECC2", "#6B7140", "#64A177"] },
  { id: 311, colors: ["#A62C37", "#F5ECC2", "#00978D", "#709390"] },
  { id: 312, colors: ["#DA525D", "#FDBF68", "#719470", "#62C6BF"] },
  { id: 313, colors: ["#AB544D", "#EEB480", "#A36AA5", "#111314"] },
  { id: 314, colors: ["#D8A37B", "#F5ECC2", "#719470", "#007190"] },
  { id: 315, colors: ["#802626", "#F5ECC2", "#C9DF75", "#111314"] },
  { id: 316, colors: ["#F8B6BA", "#FDC57E", "#A6A159", "#709390"] },
  { id: 317, colors: ["#A62C37", "#F8ED43", "#00B49B", "#6450A1"] },
  { id: 318, colors: ["#F5ECC2", "#F99D1B", "#78CDD0", "#007190"] },
  { id: 319, colors: ["#EEB480", "#FCC79B", "#8B835B", "#713B4C"] },
  { id: 320, colors: ["#F8ED43", "#D96629", "#BCE4E5", "#006EB8"] },
  { id: 321, colors: ["#E2625E", "#F5ECC2", "#00978D", "#00908A"] },
  { id: 322, colors: ["#E31F26", "#A84222", "#BF5892", "#6450A1"] },
  { id: 323, colors: ["#FDC57E", "#B2B73E", "#762C19", "#111314"] },
  { id: 324, colors: ["#AB2439", "#5A82B3", "#A36AA5", "#B6BFC1"] },
  { id: 325, colors: ["#DA525D", "#FBE6A0", "#E2B540", "#112F2C"] },
  { id: 326, colors: ["#F5ECC2", "#F15A30", "#AFD472", "#87C540"] },
  { id: 327, colors: ["#F37F94", "#BB7125", "#C2AE93", "#C0A9B3"] },
  { id: 328, colors: ["#A84222", "#F68C50", "#4B3317", "#00908A"] },
  { id: 329, colors: ["#FDBF68", "#C0A9B3", "#501345", "#34454C"] },
  { id: 330, colors: ["#C1C494", "#BCE4E5", "#97ACC8", "#099197"] },
  { id: 331, colors: ["#C53C69", "#0D1C43", "#9A72AA", "#4F4086"] },
  { id: 332, colors: ["#F58E84", "#CB2F43", "#253122", "#004F46"] },
  { id: 333, colors: ["#AE5224", "#F8ED43", "#96D1AA", "#006EB8"] },
  { id: 334, colors: ["#FDD4BD", "#837E31", "#AFD472", "#007190"] },
  { id: 335, colors: ["#82241F", "#F99D1B", "#4F4086", "#34454C"] },
  { id: 336, colors: ["#F37F94", "#793327", "#FFEFAE", "#42533E"] },
  { id: 337, colors: ["#6D4145", "#CA92A8", "#713B4C", "#111314"] },
  { id: 338, colors: ["#A62C37", "#FCB315", "#004F46", "#C0A9B3"] },
  { id: 339, colors: ["#D8A37B", "#D96629", "#A5C8D1", "#40456A"] },
  { id: 340, colors: ["#F15A30", "#00B49B", "#B6BFC1", "#111314"] },
  { id: 341, colors: ["#F48067", "#437742", "#253122", "#A5C8D1"] },
  { id: 342, colors: ["#F8B6BA", "#FDBF68", "#986F2D", "#253122"] },
  { id: 343, colors: ["#AE5224", "#EBD3A2", "#635A3A", "#064F6E"] },
  { id: 344, colors: ["#FDC57E", "#1C4286", "#A36AA5", "#111314"] },
  { id: 345, colors: ["#793327", "#BCE4E5", "#62C6BF", "#6450A1"] },
  { id: 346, colors: ["#B73F74", "#B5DECC", "#C7D14F", "#6D7E77"] },
  { id: 347, colors: ["#A6A159", "#00B49B", "#005B8D", "#B984AF"] },
  { id: 348, colors: ["#C1C494", "#437742", "#253122", "#501345"] },
  { id: 349, colors: ["#B71F57", "#007190", "#1C4286", "#111314"] },
  { id: 350, colors: ["#FCB315", "#96874D", "#709390", "#704357"] },
  { id: 351, colors: ["#F37F94", "#FDD4BD", "#A7D4E4", "#064F6E"] },
  { id: 352, colors: ["#C53C69", "#F8ED43", "#78CDD0", "#111314"] },
  { id: 353, colors: ["#FCC79B", "#CAB356", "#C16B27", "#B7C2A9"] },
  { id: 354, colors: ["#E31F26", "#F3A257", "#BCE4E5", "#006EB8"] },
  { id: 355, colors: ["#B73F74", "#4B3317", "#00B49B", "#007190"] },
  { id: 356, colors: ["#F8ED43", "#A49531", "#A5C8D1", "#B5B1D8"] },
  { id: 357, colors: ["#CAB356", "#A5C8D1", "#9A72AA", "#34454C"] },
  { id: 358, colors: ["#F8ED43", "#F37420", "#B4CDC2", "#007190"] },
  { id: 359, colors: ["#F8ED43", "#762C19", "#BCE4E5", "#B6BFC1"] },
  { id: 360, colors: ["#5A82B3", "#064F6E", "#7A4456", "#4F4086"] },
];

// Get a specific palette by ID
export function getPaletteById(id: number): ColorPalette | undefined {
  return colorPalettes.find(p => p.id === id);
}

// Calculate relative luminance of a hex color (WCAG 2.0)
function getLuminance(hexColor: string): number {
  // Remove # if present
  const hex = hexColor.replace('#', '');

  // Convert to RGB
  const r = parseInt(hex.substring(0, 2), 16) / 255;
  const g = parseInt(hex.substring(2, 4), 16) / 255;
  const b = parseInt(hex.substring(4, 6), 16) / 255;

  // Apply gamma correction
  const sRGB = [r, g, b].map(channel => {
    return channel <= 0.03928
      ? channel / 12.92
      : Math.pow((channel + 0.055) / 1.055, 2.4);
  });

  // Calculate relative luminance
  return 0.2126 * sRGB[0] + 0.7152 * sRGB[1] + 0.0722 * sRGB[2];
}

// Split palette colors into light and dark based on luminance
function splitPaletteByLuminance(palette: ColorPalette): {
  lightColors: string[];
  darkColors: string[];
} {
  const threshold = 0.5;
  const lightColors: string[] = [];
  const darkColors: string[] = [];

  palette.colors.forEach(color => {
    const luminance = getLuminance(color);
    if (luminance > threshold) {
      lightColors.push(color);
    } else {
      darkColors.push(color);
    }
  });

  return { lightColors, darkColors };
}

// Simple hash function for deterministic color selection
function hashString(str: string): number {
  let hash = 0;
  for (let i = 0; i < str.length; i++) {
    const char = str.charCodeAt(i);
    hash = ((hash << 5) - hash) + char;
    hash = hash & hash; // Convert to 32bit integer
  }
  return Math.abs(hash);
}

// Pick background and foreground from a palette deterministically based on seed
// Ensures proper contrast by pairing light backgrounds with dark text and vice versa
// Cycles through different color combinations to showcase all 4 colors in the palette
// Also shows reversed combinations (bg/fg swap) for more variety
export function getColorsForId(palette: ColorPalette, id: string): { bg: string; fg: string } {
  const hash = hashString(id);
  const { lightColors, darkColors } = splitPaletteByLuminance(palette);

  // If we have both light and dark colors, create varied pairings
  if (lightColors.length > 0 && darkColors.length > 0) {
    // Use different parts of the hash to select from each group
    const lightIndex = (hash >> 2) % lightColors.length;
    const darkIndex = (hash >> 6) % darkColors.length;

    // Determine orientation: should we use light or dark as background?
    // This will vary across items, showing both combinations
    const useLightBg = (hash >> 10) % 2 === 0;

    if (useLightBg) {
      // Light background with dark foreground
      return {
        bg: lightColors[lightIndex],
        fg: darkColors[darkIndex],
      };
    } else {
      // Dark background with light foreground (reversed)
      return {
        bg: darkColors[darkIndex],
        fg: lightColors[lightIndex],
      };
    }
  }

  // Fallback for edge cases (all light or all dark palette)
  if (lightColors.length === 0 && darkColors.length > 0) {
    // All dark colors - use different shades for variety
    const bgIndex = hash % darkColors.length;
    const fgIndex = (hash + 1) % darkColors.length;
    // Ensure bg and fg are different
    const actualFgIndex = fgIndex === bgIndex ? (fgIndex + 1) % darkColors.length : fgIndex;
    return {
      bg: darkColors[bgIndex],
      fg: darkColors[actualFgIndex],
    };
  } else if (darkColors.length === 0 && lightColors.length > 0) {
    // All light colors - use different shades for variety
    const bgIndex = hash % lightColors.length;
    const fgIndex = (hash + 1) % lightColors.length;
    // Ensure bg and fg are different
    const actualFgIndex = fgIndex === bgIndex ? (fgIndex + 1) % lightColors.length : fgIndex;
    return {
      bg: lightColors[bgIndex],
      fg: lightColors[actualFgIndex],
    };
  }

  // Final fallback - cycle through all palette colors
  const bgIndex = hash % palette.colors.length;
  const fgIndex = (hash + 2) % palette.colors.length;
  return {
    bg: palette.colors[bgIndex],
    fg: palette.colors[fgIndex],
  };
}

// Legacy function for backward compatibility
export function getRandomColors(palette: ColorPalette): { bg: string; fg: string } {
  return {
    bg: palette.colors[0],
    fg: palette.colors[1],
  };
}
